# Network Engineering and Troubleshooting
> 日常的网络问题层出不穷，实在太多有点记忆不够用，在这里开一篇再好不过，随时查阅。
另外，基础的网络学习也一起放在这吧





## 很多github.io个人网站打不开
排除过超多原因（VPN, hosts,ISP,DNS)后，发现只针对github.io的话，最主要的是github.io全线强制性改成了必须用https访问。所以很多repo中显示的github.io的链接前没有加`https://`就会造成打不开链接。





## 访问谷歌被屏蔽 （未解决）
> 访问谷歌时被谷歌强制验证，通过验证后才能访问谷歌。这种一般是走代理访问时才会发现。

![image](https://user-images.githubusercontent.com/14041622/35427767-57c4db66-02a6-11e8-8263-9e7fa7522bae.png)






## ssh的`known_hosts`
位置在`~/.ssh/known_hosts`





# HTTP协议 学习
主要看阮一峰入门：
http://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html

http://www.ruanyifeng.com/blog/2012/06/internet_protocol_suite_part_ii.html

http://www.ruanyifeng.com/blog/2016/08/http.html

互联网协议，实际上不管是7层还是5层，
说白了就是一个洋葱，一层一层被剥开。
不管二进制码怎么样，直接用json直白一点：
```javascript
{ //实体层
    “Head”: "头",
    “Data: { //链接层
        “Head”: “头”,
	    “Data: { //网络层
	        "Head": "头",
	        "Data": { // 传输层
	        	"Head": "头", 
	        	"Data": { //应用层
	        		"Head": "头",
	        		"Data": ""
	        	}
	        }
	    }
    }
}

```





## Chrome无法访问某特定网页 但是Safari和其它浏览器能正常访问
> 实际上这个“疑难杂症”系列的开启，就是源于今天近一个小时解决Chrome无法访问Github.io的问题。
由于现在在国内，所以装了各种Shadowsocks和Chrome切换代理插件，甚至还修改了本地的Hosts文件。所以一旦遇到无法访问网页，真是要伸手到很多地方去开启、关闭、各种调试。不过最终终于在chrome的插件管理里面找到了问题。
### 尝试方法
**由于之前安装了`AdBlock`插件，删除它**
实际上我装了以后一直没有使用这个插件，因为会被很多网站检测到并提示这个做法不道德。所以我就长期将这个插件放在不启动模式。但是没想到即便不启动，它仍然有屏蔽一些网站的功能。导致我无法访问github.io的各种个人主页。

### 解决方案后记
删除adblock插件后没多久就又无法访问了，所以再想别的问题。不断尝试后发现，只要把所有的url地址都强制改为`https://`安全链接，就能访问。





# 用Postman对手机抓包
一般人会抓头，Postman明明是API调试工具，和抓包有什么关系。其实这也就是官方对一个小tip，本身存在是为了监控本机某端口数据包的。但其实，如果指定某一个监视端口，然后让同局域网的手机通过这台电脑的这个端口联网而已。这样的话Postman就间接监控到了手机数据包。
操作没有任何难度，主要就是大家对手机将电脑视为代理连接比较陌生罢了。注意：不是让电脑开启热点充当wifi，而是手机本身已经连了wifi时设置代理为电脑而已。
具体操作在[Postman官网博客中](http://blog.getpostman.com/2016/06/26/using-postman-proxy-to-capture-and-inspect-api-calls-from-ios-or-android-devices/)





# 命令行方式的网络测速 Speed Test
一般最靠谱的网速测速是`Ookla Speedtest`这个网站，不管在国内还是国外。
![snip20180209_69](https://user-images.githubusercontent.com/14041622/36028145-dc3de332-0dd8-11e8-9e7e-8f861ace79b9.png)

不过其实它还有命令行的访问方式，这种方式最适合树莓派或者远端服务器这样的看不到显示器的网速测试。
直接在命令行里一句话（是一个词就够）就能返回一系列的测试结果。
官方Github网站在这里：[https://github.com/sivel/speedtest-cli](https://github.com/sivel/speedtest-cli)
安装方式是：只要在自己或者服务器的命令行里输入`sudo pip install speedtest-cli`即可，下载好后，直接在命令行里输入`sppedtest-cli`，回车，就会出现测试过程和结果。
![snip20180209_67](https://user-images.githubusercontent.com/14041622/36028031-832951fa-0dd8-11e8-9f15-5902bc6baab4.png)






# 让curl通过shadowsocks连接
shadowsocks是Socks5的连接方式。本地打开shadowsocks的客户端后，找到它在本机使用的端口。比如1080。然后输入如下命令就可以查看到效果：
```
curl --socks5-hostname localhost:1080 http://httpbin.org/ip
```
其中 http://httpbin.org/ip 是一个可以返回访问者ip地址的网站。
如果你的命令行返回的是你的服务器ip，那么就成功。
实践成功。





# 查看网络端口的流量
一键安装所有常用的网络监视软件：
```shell
# Ubuntu
sudo apt-get install -y iftop dstat nload iptraf ifstat nethogs bmon slurm vnstat bwm-ng cbm speedometer 

#Mac 
brew install iftop dstat nload iftraf ifstat nethogs bmon slurm vnstat bwm-ng cbm speedometer 
```

###  `iftop` 统计所有端口流量 （没法统计某个端口）
一般是默认安装的，需要sudo权限：`sudo iftop`。
[参考文章](https://my.oschina.net/lionel45/blog/261234)

### `iptraf`
能够看到每个网卡的当前流量，如600 kbits/sec
注意，一开始的显示颜色会很难看，需要艰难地在菜单里选择color，然后重启程序，才能正常显示。
![image](https://user-images.githubusercontent.com/14041622/36349500-5d6ed95c-14c3-11e8-958a-b7d9d2bd2851.png)

### `bmom`
动态柱状图显示进、出的流量和秒速。页面比较友好，信息简单。
![image](https://user-images.githubusercontent.com/14041622/36644611-ad365e68-1a97-11e8-9197-ad01433c1d8a.png)

### `vnstat`
画面简单，但不是动态的。只是总结日平均、月平均等。
![image](https://user-images.githubusercontent.com/14041622/36644690-1a011014-1a99-11e8-8427-f21f7a690ab6.png)

### `bwm-ng`
功能超少超简单，只显示进出流量。
![image](https://user-images.githubusercontent.com/14041622/36644702-458c73f4-1a99-11e8-8470-93ad1c965f77.png)

### `cbm`
只显示进出流量。
![image](https://user-images.githubusercontent.com/14041622/36644715-67f06586-1a99-11e8-9fee-22038e5a5640.png)

### `speed-meter`
需要输入`speedometer -r eth0 -t eth0 `执行。
只显示简单信息。但是带颜色和每个峰值的标注的界面好看。
![image](https://user-images.githubusercontent.com/14041622/36644729-aafca56a-1a99-11e8-9a8b-7ebe1d82dbfc.png)

### `slurm`
命令是`slurm -s -i eth0 `。信息很少：
![image](https://user-images.githubusercontent.com/14041622/36644676-e086bd0c-1a98-11e8-921a-3325660a0299.png)

### `ntop`
安装还需要用户名密码，这对于服务器来说太不友善了。装完了后，还打不开。。。

### `dstat`
可读性不强，也没什么好玩的显示出来。
![image](https://user-images.githubusercontent.com/14041622/36349470-b9267224-14c2-11e8-9c28-f08823913467.png)


### `nload`
画面简单，沾满全屏，只告诉你当前incoming和outgoing的流量速度。
![image](https://user-images.githubusercontent.com/14041622/36349472-cf429f92-14c2-11e8-955a-e0b42df65251.png)

### `ifstat`
极其简单只显示两个数值：进和出的秒速。
![image](https://user-images.githubusercontent.com/14041622/36349510-95a4c5ca-14c3-11e8-9b99-f4d1d24b863e.png)

### `nethogs`
需要sudo才有权限运行。
按用户显示每个用户所用的流量，基本上没什么用，数值也少。
![image](https://user-images.githubusercontent.com/14041622/36349525-f70673cc-14c3-11e8-886f-73a740be9401.png)





