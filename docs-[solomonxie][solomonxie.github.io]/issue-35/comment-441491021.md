# SSH工具集

SSH程序，如OpenSSH，都会包含一系列的工具如：
- sshd 服务端： 供别人登录本机
- ssh 客户端：用来登录连接另一台电脑
- ssh-copy-id：把本机公钥上传到另一台电脑
- ssh-agent：管理本机的私钥，并记住私钥的密码，省去每次输入的麻烦
    - ssh-add：把本机的私钥加入到ssh-agent的管理之中

也就是说，只要本机装了SSH，就自动包括了这些工具，无需额外安装。

## ssh-copy-id

是个极其方便的小命令，即把本机`~/.ssh/`目录下的所有public公钥写入到指定服务器上的`~/.ssh/authorized_keys`文件中。比起以往自己手动复制本地的公钥然后ssh进入服务器用vim打开autorized_keys粘贴，这个命令一步到位，很方便。

命令很简单：
```sh
$ ssh-copy-id 用户名@服务器地址
```

不加任何参数，命令就会把本机`~/.ssh/`目录下所有公钥上传上去。
如果要手动指定，则用`-i`指令：
```sh
$ ssh-copy-id -i /path/to/public_key
```


## ssh-agent

简而言之，ssh-agent会管理本机的私钥，并记住私钥的密码，省去每次输入的麻烦。
它不是默认启动的，如果我们启动它，就会开启一个daemon守护进程，不间断运行以帮助我们免密码并安全的登录各种远端服务器。

`ssh-agent`这个命令的本质，实际上只是修改几个环境变量，打印出一个进程ID。所以我们不能直接运行，而是要用eval命令来运行它。

![image](https://user-images.githubusercontent.com/14041622/48987707-326ba200-f15c-11e8-96db-16d59a284b3e.png)


主要步骤有两步：
```sh
# 开启ssh-agent守护进程 (使用反引号)
$ eval `ssh-agent`

# 将默认私钥(~/.ssh/id_rsa) 添加到agent管理之中
$ ssh-add

# 或，将指定私钥加入管理
$ ssh-add /path/to/key

# 关闭agent
pkill ssh-agent
```

这就完成了！
