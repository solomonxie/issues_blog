# `AWS S3 静态云存储`


## 创建Bucket
登录AWS进入S3 -> create bucket -> 创建S3全网唯一名称 -> 默认选项 -> 选择公开数据的浏览权限 -> 完成创建Bucket。


过程十分简单，就不截图占地方了。之后都可以修改，填错了也没问题。

下一步：获取`secret_key`，用于之后各种访问。

进入[`官网`](https://console.aws.amazon.com/iam/home?#/security_credential)创建key:
选择左侧User -> 为s3创建专门的用户(IAM) -> 输入名称、密码 -> 成功后，获取这个用户独有的key pair -> 记住key pair。

## 用`s3fs`将S3挂载为本地文件夹


注意：`Public access`权限必须设置成`Everyone`，要不然无法从各种程序访问。
进入bucket的管理后台，选择`Permissions`，然后设置`Public access`:
![image](https://user-images.githubusercontent.com/14041622/47804642-4ba54c80-dd70-11e8-9adc-3ebd8074bd61.png)


```sh
# https://cloud.netapp.com/blog/amazon-s3-as-a-file-system
sudo apt-get install -y s3fs

# Change key pairs to yours
echo ACCESS_KEY:SECRET_KEY > ~/.passwd-s3fs
chmod 600 ~/.passwd-s3fs

# Mount the aws S3 bucket
mkdir ~/s3-drive
/usr/bin/s3fs Your-Bucket-Name ~/s3-drive

# Show all the mounted devices
mount

# Show what's in the bucket
sudo ls ~/s3-drive
```

## `将S3作为Webdav服务器`
搜遍了全网，都没找到靠谱的S3转Webdav服务器方案，差点就自己写Webdav的protocol实现了。还好，经过各种换词搜索，灵机一动，换了种思路：可不可以先把S3映射为本地drive，然后再正常把本地drive共享为webdav？
答案是：可以的。

具体做法就是：用`s3fs`映射到本地文件夹，再用`wsgidav`或apache或nginx将文件夹共享为webdav服务器。