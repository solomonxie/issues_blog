# MySQL存储过程

[参考：mysql存储过程详细教程](https://www.jianshu.com/p/7b2d74701ccd)

SQL的`Stored Procedure`存储过程，指的其实就是一个`函数`。
既然是函数，那么就会涉及这几个要点：定义函数、使用函数、变量、参数、返回值等。

> 为了方便理解，以下就不再叫它存储过程，而直接叫函数了。

在MySQL中，这几个要点的语法如下：
- 定义函数：`CREATE PROCEDURE 函数名(参数列表) BEGIN ...具体的SQL语句... END`
- 使用函数：`CALL  函数名(参数列表);`
- 参数类型：
    - `IN`: 参数被拷贝为函数内局部变量，不影响原本的变量值。`func(IN age INT)...`
    - `OUT`: 参数只是传了个引用，函数内修改的话外部变量也会变。
    - `INOUT`: 函数内修改的话外部变量也会变。
- 声明变量：`DECLARE 变量名 类型 DEFAULT 默认值;`
- 设置变量：`SET @变量名="Jason"`
- 使用变量：调用时用`@变量名`，print显示时用`SELECT @变量名;`


```sql
/* 定义函数(存储过程)的格式 */
-- 单句存储过程
CREATE PROCEDURE 函数名(参数) 一句SQL语句;
-- 如：
CREATE PROCEDURE GreetWorld( ) SELECT CONCAT('Hello', ' world'); 

-- 多句存储过程
DELIMITER //   -- 分隔符
CREATE PROCEDURE 函数名(参数类型 参数名 数据类型)
BEGIN
    具体的SQL语句
    具体的SQL语句
END //
DELIMITER ;   -- 分隔符

-- 示例：
DELIMITER //  
CREATE PROCEDURE funcName(IN p_in int)  
BEGIN   
    SELECT p_in;   
    SET p_in=2;   
    SELECT p_in;   
END //  
DELIMITER ;

-- 变量赋值
SET @p_in=1;  

-- 调用函数
CALL funcName(@p_in);


```