# 正式的介绍「Mutt」：命令行的邮件大师  [DRAFT]

为什么要用Mutt？
这个世界已经有了成百上千的漂亮邮件客户端，为什么还要用命令行里的？
其实说什么功能都没用。说到本质上，其实是一种Geek精神，一种爱折腾的精神，一种Customizability的精神。就像明明有WhatsApp，还要用IRC一样的精神；明明有Finder，还要用Ranger的精神。
在终端里待久了，会比较烦GUI，所以不管什么软件都会寻求终端的替代方案。
对于这个需求来说，在Linux的世界里，似乎就只有一个选择：Mutt。

Mutt的可配置性，强如Vim。配置起来也和Vim差不多，有专门的`~/.muttrc`供你配置软件本身。

需要理解的是：**Mutt本身是一个框架而已。收件、发件、编辑邮件等功能，是要通过搭配不同的程序来做到的。**



## Mutt的搭配方案

就像穿衣搭配一样，收件发件过滤邮件转发邮件各种东西都有很多种程序可以用，mutt怎么搭配呢？
常用选项有这些：
- 收件：`fetchmail`
- MTA 发件：`sendmail`或`msmtp`或`postfix`。其中`postfix`对国内一些支持不好，`msmtp`兼容强。
- MDA 投递代理: `procmail`或`maildrop`。

一般搭配是：
- 老式搭配：mutt + fetchmail + postfix + procmail
- 新式搭配：mutt + fetchmail + msmtp + maildrop

这里我们用新式搭配来说明。

安装：
```sh
# Mac
$ brew install mutt fetchmail msmtp

# Ubuntu
$ sudo apt-get install mutt fetchmail msmtp -y
```



## 配置

mutt或各个写协作程序在配置前都是不能使用的，所以需要花好一段去了解和学习。
大概流程是：
- 配置收件：
- 配置发件：
- 配置转发：
- 配置过滤：
- 配置mutt框架本身：


### 收件：配置Fetchmail

> Fetchmail是由著名的《大教堂与集市》作者 Eric Steven Raymond 编写的。

Fetchmail是一个非常简单的收件程序，而且是`前台运行`、`一次性运行`的，意思是：你每次手动执行`fetchmail`命令，都是在前台一次收取完，程序就自动退出了，不是像一般邮件客户端一直在后台运行。
如果想后台运行，要么用cron定期收取，要么设为守护进程，要么用mutt。

fetchmail的配置文件为`~/.fetchmailrc`。然后文件权限最少要设置`chmod 600 ~/.fetchmailrc`

比如我们要设置三个邮箱账户同时收取，那么配置如下：
```
poll pop.AAA.com protocol POP3 user "me@AAA.com" password "123"
poll pop.BBB.com protocol POP3 user "me" there with password "123" is falko here fetchall
poll pop.CCC.com protocol POP3 user "me" there with password "123" is till here keep
```
其中，
- **各种参数可以不按顺序，也可以不在一行。** 空格区分每个参数
- `poll`后面是邮件服务器的地址，一般是`pop.xxx.com`
- `protocol`后面是收件协议，一般是`pop`或`pop3`
- `user`后面是用户名，可以是username，也可以是邮箱地址
- `password`后面是密码
- 以上是必填，其它都不是必要的
-  四选一：`fetchall`, `nofetchall`, `keep`, `nokeep`
- `here`, `there`, `with`, `is`等等，都不是关键词，随便写不影响参数。



### 发件：配置`~/.msmtprc`


### 主界面：配置`~/.muttrc`
