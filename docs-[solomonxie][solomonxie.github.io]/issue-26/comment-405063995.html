<!DOCTYPE html>
<!--
==============================================================================
           "GitHub HTML5 Pandoc Template" v2.1 — by Tristano Ajmone           
==============================================================================
Copyright © Tristano Ajmone, 2017, MIT License (MIT). Project's home:

- https://github.com/tajmone/pandoc-goodies

The CSS in this template reuses source code taken from the following projects:

- GitHub Markdown CSS: Copyright © Sindre Sorhus, MIT License (MIT):
  https://github.com/sindresorhus/github-markdown-css

- Primer CSS: Copyright © 2016-2017 GitHub Inc., MIT License (MIT):
  http://primercss.io/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The MIT License 

Copyright (c) Tristano Ajmone, 2017 (github.com/tajmone/pandoc-goodies)
Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (sindresorhus.com)
Copyright (c) 2017 GitHub Inc.

"GitHub Pandoc HTML5 Template" is Copyright (c) Tristano Ajmone, 2017, released
under the MIT License (MIT); it contains readaptations of substantial portions
of the following third party softwares:

(1) "GitHub Markdown CSS", Copyright (c) Sindre Sorhus, MIT License (MIT).
(2) "Primer CSS", Copyright (c) 2016 GitHub Inc., MIT License (MIT).

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
==============================================================================-->
<html>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>comment-405063995</title>
  <style type="text/css">
.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:16px;line-height:1.5;word-wrap:break-word;box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:45px}.markdown-body a{color:#0366d6;background-color:transparent;text-decoration:none;-webkit-text-decoration-skip:objects}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body a:hover{text-decoration:underline}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body strong{font-weight:600}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em;margin:.67em 0;padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{padding-bottom:.3em;font-size:1.5em;border-bottom:1px solid #eaecef}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body img{border-style:none}.markdown-body svg:not(:root){overflow:hidden}.markdown-body hr{box-sizing:content-box;height:.25em;margin:24px 0;padding:0;overflow:hidden;background-color:#e1e4e8;border:0}.markdown-body hr::before{display:table;content:""}.markdown-body hr::after{display:table;clear:both;content:""}.markdown-body input{margin:0;overflow:visible;font:inherit;font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dd{margin-left:0}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body code{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body pre{font:12px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;word-wrap:normal}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body table{display:block;width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body code{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code::after,.markdown-body code::before{letter-spacing:-.2em;content:"\00a0"}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code::after,.markdown-body pre code::before{content:normal}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body kbd{box-shadow:inset 0 -1px 0 #959da5;display:inline-block;padding:3px 5px;font:11px/10px SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;color:#444d56;vertical-align:middle;background-color:#fcfcfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown-body::before{display:table;content:""}.markdown-body::after{display:table;clear:both;content:""}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.Alert,.Error,.Note,.Success,.Warning{padding:11px;margin-bottom:24px;border-style:solid;border-width:1px;border-radius:4px}.Alert p,.Error p,.Note p,.Success p,.Warning p{margin-top:0}.Alert p:last-child,.Error p:last-child,.Note p:last-child,.Success p:last-child,.Warning p:last-child{margin-bottom:0}.Alert{color:#246;background-color:#e2eef9;border-color:#bac6d3}.Warning{color:#4c4a42;background-color:#fff9ea;border-color:#dfd8c2}.Error{color:#911;background-color:#fcdede;border-color:#d2b2b2}.Success{color:#22662c;background-color:#e2f9e5;border-color:#bad3be}.Note{color:#2f363d;background-color:#f6f8fa;border-color:#d5d8da}.Alert h1,.Alert h2,.Alert h3,.Alert h4,.Alert h5,.Alert h6{color:#246;margin-bottom:0}.Warning h1,.Warning h2,.Warning h3,.Warning h4,.Warning h5,.Warning h6{color:#4c4a42;margin-bottom:0}.Error h1,.Error h2,.Error h3,.Error h4,.Error h5,.Error h6{color:#911;margin-bottom:0}.Success h1,.Success h2,.Success h3,.Success h4,.Success h5,.Success h6{color:#22662c;margin-bottom:0}.Note h1,.Note h2,.Note h3,.Note h4,.Note h5,.Note h6{color:#2f363d;margin-bottom:0}.Alert h1:first-child,.Alert h2:first-child,.Alert h3:first-child,.Alert h4:first-child,.Alert h5:first-child,.Alert h6:first-child,.Error h1:first-child,.Error h2:first-child,.Error h3:first-child,.Error h4:first-child,.Error h5:first-child,.Error h6:first-child,.Note h1:first-child,.Note h2:first-child,.Note h3:first-child,.Note h4:first-child,.Note h5:first-child,.Note h6:first-child,.Success h1:first-child,.Success h2:first-child,.Success h3:first-child,.Success h4:first-child,.Success h5:first-child,.Success h6:first-child,.Warning h1:first-child,.Warning h2:first-child,.Warning h3:first-child,.Warning h4:first-child,.Warning h5:first-child,.Warning h6:first-child{margin-top:0}h1.title,p.subtitle{text-align:center}h1.title.followed-by-subtitle{margin-bottom:0}p.subtitle{font-size:1.5em;font-weight:600;line-height:1.25;margin-top:0;margin-bottom:16px;padding-bottom:.3em}div.line-block{white-space:pre-line}
  </style>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<article class="markdown-body">
<h1 id="树莓派安装samba文件共享服务器nas">树莓派安装Samba文件共享服务器（NAS）</h1>
<p>终于有点时间来解决下家中NAS需求了。一般自制NAS，只有选Samba。速度比FTP快，便利性比Windows文件夹共享好，设置多等等。</p>
<p><a href="https://github.com/jaywcjlove/handbook/blob/master/CentOS/samba.md">▶参考：samba简介</a></p>
<h2 id="安装samba">安装Samba</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1">$ <span class="fu">sudo</span> apt-get update</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">$ <span class="fu">sudo</span> apt-get install samba samba-common-bin</a></code></pre></div>
<h2 id="核心步骤配置samba">核心步骤：配置Samba</h2>
<blockquote>
<p>Samba唯一设置的入口就算一个<code>smb.conf</code>文件，所有变化都依次而来，出了问题也只需要在这里找原因。</p>
</blockquote>
<p>配置之前先说明， 这里我不打算只共享一个文件夹，而是共享树莓派连接上的所有外置硬盘。 树莓派的外置硬盘默认挂载在了<code>/media/pi</code>目录下，每个硬盘挂载为<code>/media/pi/drive1</code>，<code>/media/pi/drive2</code>等。 所以不用一个一个共享，直接把<code>/media/pi</code>共享就OK了。 下面配置还会限制：只有<code>pi</code>这个用户可以访问。</p>
<p>常用且肯定没问题的最简单配置如下：</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># 编辑Samba的配置文件</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="fu">sudo</span> vim /etc/samba/smb.conf</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># 文件末尾添加这个共享文件夹的定义：</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">[<span class="ex">NAS</span>]</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="ex">comment</span> = NAS External drive</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="ex">path</span> = /media/pi</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="ex">public</span> = Yes</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="ex">browseable</span> = Yes</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="ex">writeable</span> = Yes</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="ex">valid</span> users=pi</a></code></pre></div>
<p>其中： - <code>valid users</code>：只允许指定的用户和用户组访问</p>
<h2 id="设置samba用户名和密码">设置Samba用户名和密码</h2>
<p>这一步也至关重要，直接影响各设备的访问。 注意，这个用户必须是本机已经在group和user里面都存在的用户，且必须权限设置什么的符合samba要求才行。否则会导致有些设备完全无法访问这个文件夹。 之前试了自己<code>groupadd</code>和<code>useradd</code>本地用户后，又在samba里<code>smbpasswd -a</code>添加用户名密码，结果Mac完全访问不了，Windows也是根据系统的不同有的能访问有的不能访问。 所以这里推荐用树莓派的默认用户名<code>pi</code>：</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># 输入Samba用户的访问密码</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="fu">sudo</span> smbpasswd -a pi</a></code></pre></div>
<h2 id="重启samba">重启Samba</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># 推荐重启方法（可以看到自检过程）</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">$ <span class="fu">sudo</span> /etc/init.d/samba restart</a></code></pre></div>
<p>到这一步，如果没出问题的话，就会显示成功： <img src="https://user-images.githubusercontent.com/14041622/42730143-053748c0-8820-11e8-814e-d85bf7090dce.png" alt="image" /></p>
<p>按照之前的配置，现在你就可以访问Samba共享文件夹了。</p>
<h2 id="访问方法">访问方法</h2>
<p>一般访问方法如下： - Windows：直接打开桌面的网络（网上邻居）-&gt; RaspberryPi(树莓派的网络名)，然后就可以看到树莓派上所有共享的文件夹和设备了。 - Mac: 稍微麻烦一点，在Finder中点击菜单 -&gt; Go -&gt; Connect to server -&gt; 输入<code>smb://IP地址</code>，按照要求输入本机或树莓派的Samba用户名密码： <img src="https://user-images.githubusercontent.com/14041622/42736889-41f02f68-88a0-11e8-9b9c-87a1de108457.png" alt="image" /></p>
<p>然后可以看到，目录中和本地目录几乎没什么区别：能看预览，支持所有文件夹正常的快捷键，随意拷贝粘贴，这是FTP远不能比的。</p>
<figure>
<img src="https://user-images.githubusercontent.com/14041622/42730221-a50fd88e-8821-11e8-8221-13bf36273ec4.png" alt="image" /><figcaption>image</figcaption>
</figure>
<h2 id="将samba的共享目录映射到本地">将Samba的共享目录映射到本地</h2>
<p>Windows上，直接在文件夹里点击菜单-&gt;工具-&gt;映射网络驱动器。然后选择映射出来的驱动盘字母，点击浏览，选择网络邻居里的树莓派，确定完成。就会在本地的计算机里显示出映射磁盘了。</p>
<p>Mac上，一般在文件夹里面通过<code>Cmd+K</code>连接服务器后打开共享文件夹后，系统就会自动把它挂载到<code>/Volumes/你的共享文件夹名</code>这里。可以直接通过命令行随意访问。然后即使桌面上的文件夹关闭后，也还是可以在命令行里正常访问。</p>
<h2 id="多用户访问samba">多用户访问Samba</h2>
<p>我们用Samba，就肯定有多用户需求。 但是多用户问题恰是Samba最麻烦的地方，如果是像我这样对Linux用户权限不熟悉的话。</p>
<p>首先需要明了： <strong>Samba的里面添加的用户，必须是Linux已经存在的用户！</strong> 而且这个用户必须有相应的权限，才行。</p>
<p>所以多用户策略大概如下： - 创建Linux本机用户组，并赋予相应权限 - 创建Linux本机的用户，并赋予相应权限 - 创建共享文件夹，修改文件夹权限，修改文件夹所有者，改为对应的Samba用户或用户组 - 创建与Linux用户对应的Samba用户，并创建密码 - 在Samba配置文件里面，声明有权访问共享文件夹的用户或用户组</p>
<blockquote>
<p>注意：挂载的NTFS磁盘，是不支持unix体系的group和user的，所以里面的文件默认所有者和所属组都是root。要解决这个，需要在mount挂载时就指定所有者，但是也不能分别指定里面某个文件夹或目录的所有者。</p>
</blockquote>
<h2 id="samba调试">Samba调试</h2>
<h3 id="samba的自检程序testparm">Samba的自检程序<code>testparm</code></h3>
<p>自动测试，并显示Samba所有的共享和定义：</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1">$ <span class="ex">testparm</span></a></code></pre></div>
<figure>
<img src="https://user-images.githubusercontent.com/14041622/42730699-a3387ab4-882d-11e8-85bb-8c669fa1495b.png" alt="image" /><figcaption>image</figcaption>
</figure>
<h3 id="列出当前所有已注册的samba用户">列出当前所有已注册的Samba用户</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1">$ <span class="fu">sudo</span> pdbedit -L</a></code></pre></div>
<figure>
<img src="https://user-images.githubusercontent.com/14041622/42769960-5770ccb0-8956-11e8-8305-cba691304a95.png" alt="image" /><figcaption>image</figcaption>
</figure>
<h3 id="使用smbclient测试">使用smbclient测试</h3>
<p>smbclinet是命令行客户端，需要下载安装使用：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># 安装</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">$ <span class="fu">sudo</span> apt-get install smbclient</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># 连接Samba服务器</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">$ <span class="ex">smbclient</span> //192.168.1.111/share -U sambaUser01</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">$ <span class="ex">smb</span>: ls</a></code></pre></div>
<p>如果连接成功，就会进入smb的交互shell，然后输入ls，成功列出目录，则连接完全成功。 这是常用的最方便的测试方法，如果有任何一点不成功，这个连接命令都无法执行。 只要这里能够正常访问，那么其它地方都没有问题。</p>
<h2 id="常见问题">常见问题</h2>
<h3 id="mac上能用guest访问却不能用设置了的用户访问">Mac上能用guest访问却不能用设置了的用户访问</h3>
<p>这个是你的Samba用户设置出了问题。 有可能是Samba中定义的用户，在本机中权限不够。 解决方法就是： - 直接用树莓派的原生用户<code>pi</code>，或 - 仔细研究新创建的用户权限，添加好了再到Samba配置中设置</p>
<h3 id="原生用户pi以外的用户都不能访问外置磁盘">原生用户<code>pi</code>以外的用户都不能访问外置磁盘</h3>
<p>尝试过多用户方案，只要不是外置磁盘，都能正常访问、读写。 但是插的U盘，外置移动硬盘，除了<code>pi</code>用户以外全都只能进入，不能写入。 就算把新建用户升级到超级用户， 就算把文件目录的所有者改为新建的用户， 也还是一样的。</p>
<h3 id="消除来自mac的.ds_store文件安全隐患">消除来自Mac的.DS_Store文件安全隐患</h3>
<p>Mac上访问远程文件夹会留下<code>.DS_Store</code>文件，其中包含太多信息这样很不安全。 所以我们要在Mac上设置，在访问远程文件夹时不留下这个文件：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1">$ <span class="ex">defaults</span> write com.apple.desktopservices DSDontWriteNetworkStores true</a></code></pre></div>
<p>但是以上方法不是完全生效，目前MacOS 10.12以上都不一定能生效。</p>
<h3 id="访问外置硬盘permission-denied">访问外置硬盘Permission Denied</h3>
<p>这个也是用户权限问题，配置原生<code>pi</code>用户就没问题了。</p>
</article>
</body>
</html>
