# Authlib强大OAuth框架入门

基于Python的Authlib是集所有主流WebAPI权限认证协议的客户端、服务端、底层实现、高层架构于一身的强大工具库。

[参考官方：Authlib: Python Authentication](https://docs.authlib.org/en/latest/)

Authlib几乎是能将RFC所有相关的API认证协议都包括进来了，甚至从协议的底层实现、高层架构，从客户端到服务端都能实现的，当之无愧称为`Monolithic project `的一个项目。

目前Authlib支持的Authentication协议有：
- OAuth 1.0
- OAuth 2.0
- JWT
- many more...

安装：
```sh
$ pip install Authlib
```


## Oauth2.0客户端验证

[参考官方：Authlib - Client Guide - OAuth 2 Session](https://docs.authlib.org/en/latest/client/oauth2.html)

Authlib中用来登录验证OAuth2.0的对象叫`Session`，其中包括了所有相关的验证所需方法函数。

```py
# 生成session，用来之后的创建URL、获取token、刷新token等所有动作
>>> from authlib.client import OAuth2Session
>>> client_id = 'Your GitHub client ID'
>>> client_secret = 'Your GitHub client secret'
>>> scope = 'user:email'  # we want to fetch user's email
>>> session = OAuth2Session(client_id, client_secret, scope=scope)

# 生成URL
>>> authorize_url = 'https://github.com/login/oauth/authorize'
>>> uri, state = session.create_authorization_url(authorize_url)
>>> print(uri)

# 「手动」打开浏览器访问URI，或者自己有服务器的话，可以自己接收
#。。。

# 将callback返回的URL保留下来，因为其中包含授权code
>>> authorization_response = 'https://example.com/github?code=42..e9&state=d..t'
>>> access_token_url = 'https://github.com/login/oauth/access_token'
>>> token = session.fetch_access_token(access_token_url, authorization_response=authorization_response)
>>> print(token)
{
    'access_token': 'e..ad',
    'token_type': 'bearer',
    'scope': 'user:email'
}
```