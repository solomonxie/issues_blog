#  ❖ Git文件历史追踪问题

> 有很多时候，git追踪某一个文件的变化历史和轨迹，是非常重要的，不管是代码还是文档。这里主要说文档。但是我们的笔记、文档，总是喜欢改名和转移目录之类行踪不定，那么一旦有这些改动，git还能追踪吗？

## 文件改名 「git rename」
> git仓库实际上对文件改名这个问题是比较忌讳的，应当说是尽量避免的。因为如果不用特殊处理，改名之后git只会认为你删了这个文件，又新建了另一个文件。

如果你在系统里面手动把一个文档`1.txt`改成了`2.txt`，那么这时候输入`git status`只会看到`1.txt`被删除，新增加文件`2.txt`。
同样的，命令行里用`mv 1.md 2.md`改名，也是同样的效果。
要保持这个文件历史记录不断的话，`正确做法`是：
```
git mv 1.txt 2.txt
```
这样再用`git status`查看就会看到，识别为`renamed:   1.txt -> 2.txt `。它的历史记录就没有断。

## 文件移动 「git mv」

> 有时候会把文件移动到另一个文件夹或者某个子文件夹，但是git却认为你是删了一个而新建了另一个。

这是因为和改名一样，只要是在git命令之外移动的，git就识别不到。
所以，这里也要用`git mv`命令来移动。
```
git mv 1.txt ./src/1.txt
```
这个时候在查看git状态就会发现，显示为`renamed:   1.txt -> src/1.txt`

## 文件覆盖

> 这个问题逻辑要复杂点：有时候我们需要批量抓取网上的一些资源到这个目录里面，有些是重复的内容一样的，有些却是新的，还有些是网上删除了的，那么我们想要网上抓取的和本地的同步，应当怎么办呢？

虽然这个方法不严谨，但是非常简单有效：只要这些东西体积不是很大，那么就可以完全删除本地现有的文件，然后再把新抓取的保存到本地。
这个时候就是考验git的追踪识别能力了。
经过一系列试验发现：
- 首先不能用`git rm`删除文件，如果用了它那么不管怎么做，它都会知道你删除了文件，而我们要做的是让它误以为没有删除。
- 如果文件位置和名字没变，内容也没变，那么只要你没有add或commit，即使新生成的文件的创建日期和修改日期都变化了，`git status`也不会显示任何变动。
- 如果文件位置和名字没变，内容变化了，只要没add或commit，那么`git status`只会告诉你`modified 某文件`。
- 如果文件位置或名字变了，那么，**git完全不知道**。会认为你删除了老的，建了新的。像上面重命名的问题一样。这时候如果你还想要保持这个文件的追踪历史，要不你就尽量避免改名字，要不就想把法用`git mv`命令告知git，但是这个逻辑比较麻烦，尤其是涉及文件比较多的时候。所以我一般选择避免改名字，或干脆就断了追踪。
